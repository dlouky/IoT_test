# iot_test
IoT Engineering Test 
1.	AA_device_credentials_generator.py: 
    a.	It defines the tasks that the device must execute through the device_function variable.
    b.	The function create_credential(device_id) creates a json file with the following content
        i.	device_id: it is the serial number provided by the device factory (for this approach it is simulated with a random SHA1 hash).
        ii.	device_name: the name is an incremental integer starting from 1000001.
        iii.	credential_creation_date: when the credential was created.
        iv.	device_function: the tasks that the device must execute.
    c.	Finally, the device_id, device_name and credential_creation_date are saved in a csv (historical_credentials.csv) to keep a historical record of the generated credentials.
    d.	Only the system administrator has the permissions to run create_credential(device_id) to create the json file for the specific device_id. 
    e.	The device credentials (json files) and the historical_credentials.csv are inside the folder named device_credentials.
2.	AB_device_simulator.py: 
    a.	This script will be into each device. It has a device_id provided by the device factory.
    b.	If a credential for this device exists into the device_credentials folder, it will download the json file where device_function is present.
    c.	It recovers from the json all the tasks it should perform:
        i.	Measure the battery level, which will decrease every 10 messages sent to the MQTT broker.
        ii.	Generate json message with device_id, device_name, device_latitude, device_longitude, device_battery_level and signal_date (when the signal was emmited).
3.	AC_publisher_IoTHUB.py: 
    a.	This script will be in each device. 
    b.	It use the credentials present into azure_mqtt_credentials folder to connect to the IoT HUB.
    c.	After a successful connection, it securely sends the messages generated by AB_device_simulator.py to the MQQT broker (endpoint).
4.	AD_suscriber_IoTHUB.py: 
    a.	This script will be in client (subscriber) machine. 
    b.	It securely connects to the IoT Hub through credentials presents in azure_mqtt_credentials.
    c.	After a successful connection, it reads the messages send by the device simulator and save them into MongoDB (dabase= db_elastacloud, collection= collection_elastacloud). 
